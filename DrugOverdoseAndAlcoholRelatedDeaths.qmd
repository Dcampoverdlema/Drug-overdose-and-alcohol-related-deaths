---
title: "Drug overdose and alcohol related deaths"
author: 
- Dennis Campoverde-Lema
- Samantha Parras 
- Jodie Chen 
date: "July 26, 2024"
toc: true
format:
  html:
    theme: cosmo
    html-math-method: katex
    self-contained: true
execute:
  echo: false
  warning: false
  message: false
---

# Introduction

Use of drugs and alcohol has substantial financial consequences. Every year, excessive alcohol use costs 249 billion dollars in lost productivity, medical expenditures, and criminal justice costs. In contrast, illicit drug usage costs 193 billion dollars in lost productivity, criminality, and medical costs.

Communities can benefit from adopting and putting into practice policies that lessen prescription drug abuse and excessive alcohol consumption.

source: https://www.countyhealthrankings.org/health-data/health-factors/health-behaviors/alcohol-and-drug-use


# Our Question

**Are there demographic and social factors that are predictors of drug overdose and alcohol-related incidents (e.g., driving accidents)?**

# Data

**The data is collected by the University of Wisconsin Population Health Institute. It assigns a ranking based on health outcomes and health factors to each county in every state. There was originally 770 variables in the data set.**

**Since the data set is so big, we decided that we should create another data set with only the variables we want to look at with relation to drug overdose deaths and alcohol impaired driving deaths.** 

```{r} 
library(janitor)
library(ggplot2)
library(tidyverse)
library(sf)

```


```{r, include=FALSE}
health_data <- read.csv("data/analytic_data2024.csv") |>   
  slice(-1) |> 
  clean_names()

selected_data <- health_data |>  
  select(
    state_fips_code, county_fips_code, state_abbreviation, name,
    drug_overdose_deaths_raw_value, alcohol_impaired_driving_deaths_raw_value,
    unemployment_raw_value, income_inequality_raw_value, high_school_completion_raw_value, 
    adult_smoking_raw_value, excessive_drinking_raw_value, median_household_income_raw_value,
    some_college_raw_value, children_in_poverty_raw_value, children_in_single_parent_households_raw_value,
    social_associations_raw_value, x_below_18_years_of_age_raw_value, 
    x_65_and_older_raw_value, x_non_hispanic_black_raw_value, 
    x_american_indian_or_alaska_native_raw_value, x_asian_raw_value, 
    x_native_hawaiian_or_other_pacific_islander_raw_value, x_hispanic_raw_value, 
    x_non_hispanic_white_raw_value, x_not_proficient_in_english_raw_value, 
    x_female_raw_value, x_rural_raw_value
  )

# convert to numeric 
selected_data <- selected_data |> 
  mutate(across(
    starts_with("drug_overdose_deaths_raw_value") | starts_with("alcohol_impaired_driving_deaths_raw_value") |
      starts_with("unemployment_raw_value") | starts_with("income_inequality_raw_value") | 
      starts_with("high_school_completion_raw_value") | starts_with("adult_smoking_raw_value") |
      starts_with("excessive_drinking_raw_value") | starts_with("median_household_income_raw_value") |
      starts_with("some_college_raw_value") | starts_with("children_in_poverty_raw_value") | 
      starts_with("children_in_single_parent_households_raw_value") | 
      starts_with("social_associations_raw_value") | starts_with("x_below_18_years_of_age_raw_value") | 
      starts_with("x_65_and_older_raw_value") | starts_with("x_non_hispanic_black_raw_value") | 
      starts_with("x_american_indian_or_alaska_native_raw_value") | starts_with("x_asian_raw_value") | 
      starts_with("x_native_hawaiian_or_other_pacific_islander_raw_value") | starts_with("x_hispanic_raw_value") | 
      starts_with("x_non_hispanic_white_raw_value") | starts_with("x_not_proficient_in_english_raw_value") | 
      starts_with("x_female_raw_value") | starts_with("x_rural_raw_value"),
    as.numeric
  ))


```
 
**Upon inspection, we found that the variable of drug overdose deaths had lots of N/A values and we want to make sure this is clean as this is one of the main variables we want to look at. ** 

**Also rename the data so that it can be read easier**

```{r, include=FALSE} 
imputed_data <- read_csv("imputed_data.csv") |> 
  mutate(across(everything(), ~ifelse(is.na(.) | . == 0, mean(., na.rm = TRUE), .))) |> 
  rename(
    ID = ...1,
    Drug_Overdose_Deaths = drug_overdose_deaths_raw_value,
    Alcohol_Impaired_Driving_Deaths = alcohol_impaired_driving_deaths_raw_value,
    Unemployment_Rate = unemployment_raw_value,
    Income_Inequality = income_inequality_raw_value,
    Highschool_Comp_Rate = high_school_completion_raw_value,
    Adult_Smoking_Rate = adult_smoking_raw_value,
    Excessive_Drinking_Rate = excessive_drinking_raw_value,
    Median_House_Income = median_household_income_raw_value,
    College_Education_Rate = some_college_raw_value,
    Children_In_Poverty = children_in_poverty_raw_value,
    Single_Parent_House = children_in_single_parent_households_raw_value,
    Social_Associations = social_associations_raw_value,
    Pop_Under_18 = x_below_18_years_of_age_raw_value,
    Pop_Over_65 = x_65_and_older_raw_value,
    NH_Black = x_non_hispanic_black_raw_value,
    American_Or_Alaska_Native = x_american_indian_or_alaska_native_raw_value,
    Asian_Pop = x_asian_raw_value,
    Pacific_Islander = x_native_hawaiian_or_other_pacific_islander_raw_value,
    Hispanic_Pop = x_hispanic_raw_value,
    NH_White = x_non_hispanic_white_raw_value,
    English_Profic = x_not_proficient_in_english_raw_value,
    Female_Pop = x_female_raw_value,
    Rural_Pop = x_rural_raw_value
  )
 
```

# Methods

**First, we needed to find our variables of interest. We decided to find the p-values for drug overdose deaths and alcohol impaired deaths.**

**Going to look at drug overdose deaths first:** 

```{r} 

model_drug <- lm(drug_overdose_deaths_raw_value ~ unemployment_raw_value + income_inequality_raw_value + 
                   high_school_completion_raw_value + adult_smoking_raw_value + excessive_drinking_raw_value + 
                   median_household_income_raw_value + some_college_raw_value + children_in_poverty_raw_value + 
                   children_in_single_parent_households_raw_value + social_associations_raw_value + 
                   x_below_18_years_of_age_raw_value + x_65_and_older_raw_value + 
                   x_non_hispanic_black_raw_value + x_american_indian_or_alaska_native_raw_value + 
                   x_asian_raw_value + x_native_hawaiian_or_other_pacific_islander_raw_value + 
                   x_hispanic_raw_value + x_non_hispanic_white_raw_value + 
                   x_not_proficient_in_english_raw_value + x_female_raw_value + 
                   x_rural_raw_value, data = selected_data)

summary(model_drug)


```
**Unemployment and income inequality are strong positive predictors, meaning higher rates are associated with higher outcomes of interest. Adult smoking and female percentage are also positive predictors. Excessive drinking and under 18 population have significant negative effects. These are our variables of interest while looking at drug overdose deaths **

**Now looking at alcohol impaired driving deaths:** 

```{r}
model_alcohol <- lm(alcohol_impaired_driving_deaths_raw_value ~ unemployment_raw_value + income_inequality_raw_value + 
                      high_school_completion_raw_value + adult_smoking_raw_value + excessive_drinking_raw_value + 
                      median_household_income_raw_value + some_college_raw_value + children_in_poverty_raw_value + 
                      children_in_single_parent_households_raw_value + social_associations_raw_value + 
                      x_below_18_years_of_age_raw_value + x_65_and_older_raw_value + 
                      x_non_hispanic_black_raw_value + x_american_indian_or_alaska_native_raw_value + 
                      x_asian_raw_value + x_native_hawaiian_or_other_pacific_islander_raw_value + 
                      x_hispanic_raw_value + x_non_hispanic_white_raw_value + 
                      x_not_proficient_in_english_raw_value + x_female_raw_value + 
                      x_rural_raw_value, data = selected_data)

summary(model_alcohol)

```

**Unemployment, excessive drinking, elderly population, and English proficiency are significant factors associated with the outcome of interest. These are our variables of interest while looking at alcohol impaired driving deaths.**  

```{r}


```

## Correlation matrix 

**This is a better visual of the correlations to find our variables of interest** 

```{r}


```

